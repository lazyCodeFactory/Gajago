<%@ page language="java" contentType="text/html; charset=utf-8" pageEncoding="utf-8"%>
<%@ include file="/WEB-INF/views/web/common/cmmnHead.jsp"%>
<%@ include file="/WEB-INF/views/web/common/CmmnJuso.jsp"%>
<script type="text/javascript" src="/js/web/saleMng/byteCheckUtil.js"></script> <!-- 바이트 체크 유틸 -->




<script type="text/javascript" src="/js/web/cart.js" ></script>
<script type="text/javascript">

	var regData = '${regData}';
	var mainYn = '${params.mainYn }';
	var imgId = "";
	
	// [2015-12-04] 디폴트 이미지가 번호마다 다 달라져서 추가함
	var img = {
			getDefaultMainImgUrl : function(){
				return "http://static.ssocio.net/web/images/pic_none.png";
			},
			getDefaultSubImgUrl : function(seq){
				switch (seq){
					case 0 : case "mainImg": return "http://static.ssocio.net/web/images/pic_none.png"; break;
					case 1 : case "subImg1": return "http://static.ssocio.net/web/images/pic/bg_pic_add01.png"; break;
					case 2 : case "subImg2": return "http://static.ssocio.net/web/images/pic/bg_pic_add02.png"; break;
					case 3 : case "subImg3": return "http://static.ssocio.net/web/images/pic/bg_pic_add03.png"; break;
					case 4 : case "subImg4": return "http://static.ssocio.net/web/images/pic/bg_pic_add04.png"; break;
					case 5 : case "subImg5": return "http://static.ssocio.net/web/images/pic/bg_pic_add05.png"; break;
				}
			}
	}
	
	//ready
	$(document).ready(function(){
		
		
		
		if($("#mainImg").attr('src')==''){
			$(this).attr('src',img.getDefaultMainImgUrl());
		}
		if($("#subImg1").attr('src')==''){
			$("#subImg1").attr('src',img.getDefaultSubImgUrl(1));
		}
		if($("#subImg2").attr('src')==''){
			$("#subImg2").attr('src',img.getDefaultSubImgUrl(2));
		}
		if($("#subImg3").attr('src')==''){
			$("#subImg3").attr('src',img.getDefaultSubImgUrl(3));
		}
		if($("#subImg4").attr('src')==''){
			$("#subImg4").attr('src',img.getDefaultSubImgUrl(4));
		}
		if($("#subImg5").attr('src')==''){
			$("#subImg5").attr('src',img.getDefaultSubImgUrl(5));
		}

		// title 및 back 버튼 url set		
		document.title = "상품 수정";
		header.type	= 4;
		header.title = "상품 수정";
		header.method = "POST";
		header.backUrl = "/mobile/main/main.do";
		header.callback = headerCallback; // 장바구니용 callback
		initHeader();
		
		displayFooter(false);
		
		var essen_wd = $(".essential").width();
		var essen_ht = $(".essential").height();
		$(".essential").find(".camera_none").css({"width":essen_wd+"px","height":essen_ht+"px"});

		
		
		if('${sessionScope.APP}'=='SSOCIO'){
			$("#mainImg, #subImg1, #subImg2, #subImg3, #subImg4 , #subImg5").click(function(event){
				event.preventDefault();
				var retListJson = getCmdJson();
				console.log(retListJson);
				document.location.replace('ssocio://web/prodRegModify?' + retListJson);
			});
		}else{
			
			// 이미지 변경 이벤트
			$("#fileMainImg").change(function () {
				preView(this, 'mainImg', '');
			});
			$("#fileSubImg1").change(function () {
				preView(this, 'subImg1', '');
			});
			$("#fileSubImg2").change(function () {
				preView(this, 'subImg2', '');
				proc.delImgShow($(this).attr("id"));
			});
			$("#fileSubImg3").change(function () {
				preView(this, 'subImg3', '');
				proc.delImgShow($(this).attr("id"));
			});
			$("#fileSubImg4").change(function () {
				preView(this, 'subImg4', '');
				proc.delImgShow($(this).attr("id"));
			});
			$("#fileSubImg5").change(function () {
				preView(this, 'subImg5', '');
				proc.delImgShow($(this).attr("id"));
			});
		}

		
			

		
		/************************* step2 시작 ********************************/
		
		// 상품명 keyup event
		$("#prodNm").keypress(function (evt) {
			if (evt.keyCode == 13) {
				evt.returnValue = false;
				evt.preventDefault();
				return false;
			}
		});
// 		$("#prodNm,#prodDtl").bind('keyup input', function(evt) {
// 			proc2.prodNmKeyup();
// 		});
// 		proc2.prodNmKeyup();
		
		
		$("#prodNm,#prodDtl").bind('keyup input', function(evt) {
			if ( "evt" != proc2.strChkfnc(this, evt))
			{
				proc2.prodNmKeyup();
			}
		});
		
		
		
		// init
		proc2.procBtnDel();
		proc2.procProdNmLen();
		proc2.procProdDtlLen();
		/************************* step2 종료 ********************************/
		
		
		
		
		/************************* step3 시작 ********************************/
		tap($('.sell-prod'));
		tap($('.sell-nProd'));
		tap($('.prod-cond'));
		tap($('.ship-type'));
		tap($('.sell-dlv'));
		tap($('.sell-dlv_payment'));
		
		tooltip('list-deal');
		tooltip('sell-prod');
		tooltip('sell-nProd');
		
		// 상품 거래방식 이벤트
// 			if($(this).parent().text() == '판매'){
			if( '${prodDtl.PROD_TYPE_CD}' == 1 ){
				
				// li버튼 셋팅
				$("#dlvWayCd").attr('class','list-tab sell-prod mt10');
				tap($(".sell-prod"));
				
				// 셰어링은 제휴택배만 이요이 가능합니다 Tip 문구
				$("#sharTipText").hide();
				
				
				// 금액 입력타입
				$("#sellDiv").show();
				$("#sharDiv").hide();
				$("#nanumDiv").hide();
				
				// 배송가능지역, 거래가능지역 hide 
				$("#dlvWayDlv").show();
				$("#dlvWayCdOffLine").hide();
				$("#dlvWayCdQuick").hide();
				
			}else if( '${prodDtl.PROD_TYPE_CD}' == 2 ){
				
				// li 버튼 셋팅
				$("#dlvWayCd").attr('class','list-tab share_ship-type mt10');
				$("#dlvWayCd li a").unbind('click');
				$("#dlvWayCd li").removeClass('active');
				$("#dlvWayCd li:contains('제휴택배')").attr('class','active');

				// 셰어링은 제휴택배만 이용이 가능합니다 Tip 문구
				$("#sharTipText").show();
				
				// 제휴사로 셀렉트박스 셋팅
				$("#dlvCmpSelectEl").html(getDlvOptionHtml.dlvWayOptEl());

				// 금액 입력타입
				$("#sellDiv").hide();
				$("#sharDiv").show();
				$("#nanumDiv").hide();
				
				// 배송가능지역, 거래가능지역 hide 
				$("#dlvWayDlv").show();
				$("#dlvWayCdOffLine").hide();
				$("#dlvWayCdQuick").hide();
				
			}else if( '${prodDtl.PROD_TYPE_CD}' == 3 ){
				
				// li 버튼 셋팅
				$("#dlvWayCd").attr('class','list-tab sell-prod mt10');
				tap($(".sell-prod"));


				// 셰어링은 제휴택배만 이요이 가능합니다 Tip 문구
				$("#sharTipText").hide();
				
				// 금액 입력타입
				$("#sellDiv").hide();
				$("#sharDiv").hide();
				$("#nanumDiv").show();
				$("#nProdGbCdArea").hide();
			}
			dlvWayCdChgFunc();
		
		// 1:제휴, 2:일반, 3:우편/등기, 4:퀵, 5:직거래
		var dlvWayCd = '${prodDtl.DLV_WAY_CD}';
		if(dlvWayCd == 1){
			$("#dlvCmpSelectEl").html(getDlvOptionHtml.dlvWayOptEl()).trigger('change');	// 제휴 셋팅
			$("#dlvWayDlv").show();			// 택배방식 (제휴 또는 일반택배인 경우)
			$("#dlvWayCdOffLine").hide();	// 직거래방식
			$("#dlvWayCdQuick").hide();		// 퀵
		}else if(dlvWayCd == 2){
			$("#dlvCmpSelectEl").html(getDlvOptionHtml.dlvAllOptEl()).trigger('change');	// 일반 셋팅
			$("#dlvWayDlv").show();			// 택배방식 (제휴 또는 일반택배인 경우)
			$("#dlvWayCdOffLine").hide();	// 직거래방식
			$("#dlvWayCdQuick").hide();		// 퀵
		}else if(dlvWayCd == 3){
			$("#dlvWayDlv").hide();			// 택배방식 (제휴 또는 일반택배인 경우)
			$("#dlvWayCdOffLine").hide();	// 직거래방식
			$("#dlvWayCdQuick").hide();		// 퀵
		}else if(dlvWayCd == 4){
			$("#dlvWayDlv").hide();			// 택배방식 (제휴 또는 일반택배인 경우)
			$("#dlvWayCdOffLine").hide();	// 직거래방식
			$("#dlvWayCdQuick").show();		// 퀵
		}else if(dlvWayCd == 5){
			$("#dlvWayDlv").hide();			// 택배방식 (제휴 또는 일반택배인 경우)
			$("#dlvWayCdOffLine").show();	// 직거래방식
			$("#dlvWayCdQuick").hide();		// 퀵
		}
		
		
		// 배송방식 선택 이벤트 1:제휴, 2:일반, 3:우편/등기, 4:퀵서비스 5:직거래		
		$("#dlvWayCd li a").click(dlvWayCdChgFunc);
		
		
// 		var obj = document.getElementById("dlvCmpSelectEl");
// 		for(var i = 0; i< obj.options.length; i ++)
// 		{
// 			if (obj.options[i].value == '${prodDtl.DLV_CMP_CD}') {
// 				obj.selectedIndex = i;
// 				break;
// 			}		
// 		}
		
		
		// 판매상품 상태 이벤트 (새상품:10, 미사용:20, 중고:30, 전시상품:40)
		$("#nProdGbCd li a").click(function(){
			console.log(this);
			if($(this).parent().text() == '새상품'){
			}else if($(this).parent().text() == '미사용'){
			}else if($(this).parent().text() == '중고'){
			}else if($(this).parent().text() == '전시상품'){
			}
		});
		
		
		
		
		
		// 배송비 부담여부 이벤트 (1:판매자, 2:구매자)
		$("input[name=dlvPayGbCd]").change(function(){
			dlvAmtInit();
		});
		
		// 제휴택배사 select box 선택시, 택배비 셋팅 이벤트
  		$("#dlvCmpSelectEl").change(function(){
  			dlvAmtInit();
  				
		});
  		$("#dlvCmpSelectEl").trigger('change');
		
		
		// 기본출하지 변경 이벤트
		$("#sellerGrpSelectEl").change(function(){
			$("#addrView").html($("#sellerGrpSelectEl option:selected").attr('id'));
		});
		$("#sellerGrpSelectEl").trigger('change');
		
		
		
		// 보증금 keyup
		proc3.sharingMaxTerm();
		$("#deposit").bind('keyup input', function() {
			proc3.sharingMaxTerm();
		});
		// 셰어링 keyup
		$("#sharingPrice").bind('keyup input', function() {
			proc3.sharingMaxTerm();
		});
		proc3.setYear();
		proc3.setMonth();
		// 년도 변경
		$("#freeEndYear").change(function () {
			proc3.setMonth();
		});
		// 월 변경
		$("#freeEndMonth").change(function () {
			proc3.setDay();
		});
		proc3.setFreeShareEndDt(); // freesheare_end_dt 날짜로 셋팅
		
		
		// 제휴택배사 select box 선택시, 택배비 셋팅 이벤트
  		$("#dlvCmpSelectEl").change(function(){
  			dlvAmtInit();
		});
  		$("#dlvCmpSelectEl").trigger('change');

		
		/************************* step3 종료 ********************************/
		
		dlvWayCdChgFunc();


  		$("input[name=sellPrce],input[name=deposit],input[name=sharingPrice],input[name=dlvAmt]").bind('keyup keydown', function(evt) {
  			proc3.deciChkFnc(this, evt)
		});
  		
  		
	});


	
	
	// 처리
	var proc = {
			
			// 삭제 이미지 버튼 보여주기
			delImgShow : function (id) {
				
				if( '${sessionScope.APP}' == 'SSOCIO'){
					if ($("#"+id+"Url") != null && $("#"+id+"Url") != "") {
						$("#"+id).parent().find("a").show();
					}
					else {
						$("#"+id).parent().find("a").hide();
					}
				}
				else {
					if ($("#"+id).val() != null && $("#"+id).val() != "") {
						$("#"+id).parent().find("a").show();
					}
					else {
						$("#"+id).parent().find("a").hide();
					}
				}
				
			},
		
			// 이미지 삭제...  (앱이 아닌경우의 input file ID, seq, 이미지 태그 ID)
			procDelImg : function (id, seq, org_id) {
				
				if (!confirm("선택하신 이미지를 삭제하시겠습니까?")) {
					return;
				}
				
				if( '${sessionScope.APP}' == 'SSOCIO'){
					
					var inputId = $("#"+org_id).attr("name");
					
					
					
					$("#"+org_id+"Url").val("");
					$("#"+org_id+"Seq").val(seq+",D");
					$("#"+org_id+"Flag").val("D");
					
					$("#"+org_id).attr("src", img.getDefaultSubImgUrl(org_id));
					$("#"+org_id).parent().find("a").hide();
					
//	 				proc.procImgFlagApp(id);
				}
				else{
					$("#"+id).val("");
					$("#"+id).parent().find(" > img").attr("src", img.getDefaultSubImgUrl(org_id));
					$("#"+id).parent().find("a").hide();
					
					$("#"+org_id+"Seq").val(seq + ",D");
					
				}
				
			},
			
			// 이미지 변경 시 SEQ 받아놓기
			procImgSeq : function (seq, gubun) {
				
				
				// 기존에 seq 가 있다면 (이미지가 원래 등록 되어 있었던 슬롯이라면) , 플래그를 seq+U로
				if (seq != null && seq != "") {
					$("#"+gubun+"Seq").val(seq+",U");
				}
				
				// 그렇지 않다면 NEWIMG,I 로... 
				else {
					$("#"+gubun+"Seq").val("NEWIMG,I");
				}
				
			},

	};
	
	/********************************* step2 시작 **************************************/
	// [2015-11-11] 바이트수 체크로 변경되어 수정함.
	var prdNmBu = new strByteUtil(50);
	var prdDtlBu = new strByteUtil(1000);
	
	var proc2 = {
			
			// 상품명, 상품설명
			strChkfnc : function(obj, evt ){
				
				var rejectPattern = /[\~\!\@\#\$\&\*\(\)\|\<\>\\\=\`\^\'\"\?\\]/ig;
				var rep_rejectPattern = /[\~\!\@\#\$\&\*\(\)\|\<\>\\\=\`\^\'\"\?\\]/ig;
				
				if(rejectPattern.test(  $(obj).val()  )){
					$(obj).val($(obj).val().replace(rep_rejectPattern, ""));
				}
			},
			
			// 상품명 keyup
			prodNmKeyup : function () {
				proc2.procBtnDel();
				proc2.procProdNmLen();
				proc2.procProdDtlLen();
			},
			
			// 삭제버튼 show/hide
			procBtnDel : function () {
				var len = $("#prodNm").val().length;
				if (len > 0) {
					// 삭제버튼 on
					$("#btnDel").show();
				}
				else {
					// 삭제버튼 off
					$("#btnDel").hide();
				}
			},
			
			// 상품명 삭제
			prodNmDel : function () {
				$("#prodNm").val("");
				proc2.procBtnDel();
				proc2.procProdNmLen();
				proc2.procProdDtlLen();
			},
						
			// 상품명 글자수 spanLen
			procProdNmLen : function () {

				var str = $("#prodNm").val();
				
				// 바이트 체크해서 초과하면, 자른 글자만큼 setting 해버림
				if(!prdNmBu.byteCheck(str)){
					alert("최대 " + prdNmBu.getMaxByte() + " Byte 까지 입력 가능 합니다.");
					str = prdNmBu.getStrLimitmaxByte(str);
					$("#prodNm").val(str);
				}
				
				$("#spanProdNmLen").text(prdNmBu.getByteLength(str) + "/" + prdNmBu.getMaxByte() + " Byte");
			},
		
			// 상품명 글자수 spanLen
			procProdDtlLen : function () {

				var str = $("#prodDtl").val();
				
				// 바이트 체크해서 초과하면, 자른 글자만큼 setting 해버림
				if(!prdDtlBu.byteCheck(str)){
					alert("최대 " + prdDtlBu.getMaxByte() + " Byte 까지 입력 가능 합니다.");
					str = prdDtlBu.getStrLimitmaxByte(str);
					$("#prodDtl").val(str);
				}
				
				$("#spanProdDtlLen").text(prdDtlBu.getByteLength(str) + "/" + prdDtlBu.getMaxByte() + " Byte");
			},
	}
	/********************************* step2 종료 **************************************/
	
	
	
	/**************************************** step3 시작 ***********************************************/
	function nanumDateValide(){
		// 나눔신청마감일

			var yearIdx = $("#freeEndYear option").index($("#freeEndYear option:selected"));
			var monthIdx = $("#freeEndMonth option").index($("#freeEndMonth option:selected"));
			var dayIdx = $("#freeEndDay option").index($("#freeEndDay option:selected"));
			var freeShareEndDt = $("#freeShareEndDt").val().substr(0,8);
			var date = new Date();
			var year = date.getFullYear();
			var month = date.getMonth() + 1;
			var day = date.getDate();
			
			if (month < 10) {
				month = "0"+month;
			}
			
			if (day < 10) {
				day = "0"+day;
			}
			var today = year+""+month+""+day;
			
			// 날짜 선택
			if (yearIdx == null || yearIdx <= 0) {
				alert("마감년도를 선택해 주세요.");
				$("#freeEndYear").focus();
				return false;
			}
			if (monthIdx == null || monthIdx <= 0) {
				alert("마감월을 선택해 주세요.");
				$("#freeEndMonth").focus();
				return false;
			}
			if (dayIdx == null || dayIdx <= 0) {
				alert("마감일을 선택해 주세요.");
				$("#freeEndDay").focus();
				return false;
			}
			// 날짜크기
			if (freeShareEndDt < today) {
				alert("마감일은 오늘날짜보다 작을 수 없습니다.");
				return false;
			}
			return true;
	}	
		
	function dlvWayCdChgFunc(evt){
			
		console.log(   evt  );
		/*
			dlvWayDlv : 제휴택배 + 일반택배
			dlvWayCdOffLine : 직거래
			dlvWayCdQuick : 퀵
			??? : 우편등기
	 	*/
	 	
	 	$("#dlvWayCd li a")
		
 		// 퀵
		$("#dlvWayCdQuick").hide();
	
		// 직거래
		$("#dlvWayCdOffLine").hide();
	
		// 택배방식
		$("#dlvWayDlv").hide();
		// 택배방식 상세
	 	$("#dlvTitArea").hide();
		$("#dlvCmpArea").hide();
		
		
		// 구매자부담 판매자부담
		$("#dlvPayGbCdArea").hide();
		
		// 배송비
		$("#dlvAmtArea").hide();
			
			
		if($("#dlvWayCd li.active").text()== '제휴택배'){
			
			$("input[name=dlvPayGbCd]").eq(0).prop('checked','checked');
			$("#dlvCmpSelectEl").html( getDlvOptionHtml.dlvWayOptEl() ).trigger('change');
			$("#dlvWayDlv").show();
			$("#dlvTitArea").show();
			$("#dlvCmpArea").show();
			
			/*
				나눔일때 
				1. 판매자 구매자 부담 라디오버튼 비노출 (무조건 판매자부담으로 저장)
				2. 배송비 비노출 (부조건 0원)
			*/
			if(getParam.prodTypeCd()!=3){
				$("#dlvPayGbCdArea").show();
				$("#dlvAmtArea").show();
			}
			
		}else if($("#dlvWayCd li.active").text() == '일반택배'){
			
			$("#dlvCmpArea").show();
			$("#dlvWayDlv").show();
			$("#dlvCmpSelectEl").html( getDlvOptionHtml.dlvAllOptEl() ).trigger('change');
			$("#dlvTitArea").show();
			
			/*
				나눔일때 
				1. 판매자 구매자 부담 라디오버튼 비노출 (무조건 판매자부담으로 저장)
				2. 배송비 비노출 (부조건 0원)
			*/
			if(getParam.prodTypeCd()!=3){
				$("#dlvPayGbCdArea").show();
				$("#dlvAmtArea").show();
			}
			
		}else if($("#dlvWayCd li.active").text() == '우편/등기'){
			
			
		}else if($("#dlvWayCd li.active").text() == '퀵서비스'){
			if(getParam.prodTypeCd()!=3){
				$("#dlvWayDlv").show();
			}
			$("#dlvWayCdQuick").show();
			$("#dlvPayGbCdArea").show();
			$("#dlvWayCdQuick").show();

		}else if($("#dlvWayCd li.active").text() == '직거래'){
			$("#dlvWayCdOffLine").show();
			$("#dlvTitArea").show();
			$("#dlvCmpArea").show();
			$("#dlvAmtArea").show();
		}
	}


	var getDlvOptionHtml = {
		// private 제휴택배 엘리먼트 HTML String
		dlvWayOptEl  : function (){
			var optElEmList = "";
			<custom:codeList var="dlvCmpCd" groupCode="DLV_CMP_CD" />
			<c:forEach var="list" items="${dlvCmpCd}" varStatus="status">
				<c:forEach var="dlv" items="${relDlvInfo }">
					<c:if test="${list.key eq dlv.DLV_CMP_CD }">
						var opt = document.createElement("OPTION");								
						opt.text = '${list.value}';
						opt.value = '${list.key}';
						opt.setAttribute("dlv_amt", '${dlv.DLV_AMT}');
						optElEmList += opt.outerHTML;
					</c:if>
				</c:forEach>
	      		</c:forEach>

	    		$("#dlvCmpSelectEl").trigger('change');
	    		$("input[name=dlvAmt]").prop('readonly','readonly');
			return optElEmList;
		},
		
		// 일반택배 엘리먼트 HTML String
		dlvAllOptEl : function (){
			var optElEmList = "";
			<custom:codeList var="dlvCmpCd" groupCode="DLV_CMP_CD" />
			<c:forEach var="list" items="${dlvCmpCd}" varStatus="status">
				var opt = document.createElement("OPTION");								
				opt.text = '${list.value}';
				opt.value = '${list.key}';
				console.log('${list}');
				optElEmList += opt.outerHTML;
	      	</c:forEach>				
	      	$("input[name=dlvAmt]").prop('readonly','');
	      	return optElEmList;
		}
	}
			
		
		
		


	var getParam = {
		prodTypeCd: function (){
			// 1:판매, 2:셰어링, 3:나눔
// 			switch($("#prodTypeCd li.active").find('a').html()){
// 				case '판매' :{return 1;} break;
// 				case '셰어링' :{return 2;} break;
// 				case '나눔' :{return 3;} break;
// 				default: return null;
// 			}
			return Number('${prodDtl.PROD_TYPE_CD}');
		},
		nProdGbCd: function(){
			// 10:새상품, 20:미사용, 30:중고상품, 40:전시상품
			switch($("#nProdGbCd li.active").find('a').html()){
				case '새상품' :{return 10;} break;
				case '미사용' :{return 20;} break;
				case '중고' :{return 30;} break;
				case '전시상품' :{return 40;} break;
				default: return null;
			}
		},
		dlvWayCd: function(){
			// 1:제휴택배, 2:일반택배, 5:직거래
			switch($("#dlvWayCd li.active").find('a').html()){
				case '제휴택배' :{return 1;} break;
				case '일반택배' :{return 2;} break;
				case '우편/등기' :{return 3;} break;
				case '퀵서비스' :{return 4;} break;
				case '직거래' :{return 5;} break;
				default: return null;
			}
		},
		grpRegTypeFlag: function(){
			// NEW , OLD
			switch($("#newGrp").css('display')){
				case 'block' :{return "NEW";} break;
				case 'none' :{return "OLD";} break;
				default: return null;
			}
		},
		
//	 	dlvPayGbCd: function(){
//	 		// 1:구매자부담, 2:판매자부담
//	 		return $("input[name=dlvPayGbCd]:checked").val();
//	 	},
		dlvCmpCd: function(){
			return $("#dlvCmpSelectEl").val();
		}
		
	};
	
	
	// getImgForApp('{"list":[{"FILE_SEQ":"2015121000040024","FILE_URL":"http://cdn.ssocio.com/2015/12/10/bbf70f87-8287-426f-9869-1a12857a7fcc.PNG"},{"FILE_SEQ":"2015121000040025","FILE_URL":"http://cdn.ssocio.com/2015/12/10/06e61a63-136d-4315-9ea1-0bdbff358bbe.PNG"}],"callback":"getImgForApp"}');
	
	
	// [이미지] 앱에서 주는 json 처리
	function getImgForApp(obj){
		
		
		// 1. 이미지를 모두 삭제 ',D'
		$(".pure-pic_img").each(function(key, val){
			if (key==0){
				$(this).attr('src',img.getDefaultMainImgUrl());
			}else{
				$(this).attr('src',img.getDefaultSubImgUrl(key));
			}
		});
		
		// 2. seq 제거
		$(".imgSeq").each(function(key,val){
			$(this).val("");
		});
		
		// 3. 기존에 seq 가 있던놈은 ',U' 아닌놈은 ',I' 로 
		var obj = JSON.parse(obj);
		
		$.each(obj.list, function(key,val){
			var seq = this.FILE_SEQ;
			var url = this.FILE_URL;
			
			$(".pure-pic_img").eq(key).attr('src',url);
			$(".imgSeq").eq(key).val(seq);
		});
		
		// 4. delImg 삭제
		$(".delImg").hide();
		
	}
	// [이미지] 앱한테 줄 json 생성
	var getCmdJson = function (){
		var list = new Array();
		list.push(
				{"FILE_SEQ":$("#mainImgSeq").val().split(',')[0],"FILE_URL":$("#mainImg").attr('src') }
				,{"FILE_SEQ":$("#subImg1Seq").val().split(',')[0],"FILE_URL":$("#subImg1").attr('src') }
				,{"FILE_SEQ":$("#subImg2Seq").val().split(',')[0],"FILE_URL":$("#subImg2").attr('src') }
				,{"FILE_SEQ":$("#subImg3Seq").val().split(',')[0],"FILE_URL":$("#subImg3").attr('src') }
				,{"FILE_SEQ":$("#subImg4Seq").val().split(',')[0],"FILE_URL":$("#subImg4").attr('src') }
				,{"FILE_SEQ":$("#subImg5Seq").val().split(',')[0],"FILE_URL":$("#subImg5").attr('src') }
		);
		$.each(list, function(key,val){
			if (this.FILE_SEQ == null || this.FILE_SEQ.length < 15 || this.FILE_URL == img.getDefaultSubImgUrl(key)){
				list.splice(key);
			}
		});
		return JSON.stringify({"list":list , "callback":"getImgForApp"});			
	};
	
	
	// [2015-12-22]
	var updateBeforeProdStatCdChk = {
		prodStatCd : null,
		prodStatCdChk : function(){
			$.ajax({
				type: "post",
				async: false,
				data: {prodCode :"${prodDtl.PROD_CODE }"}, 
				url: "/mobile/salemanage/selectProdStat.do",
				dataType:"json",
				success: function(data) {
					console.log(data.prodStatCd);
					updateBeforeProdStatCdChk.prodStatCd = data.prodStatCd;
				},
				error: function(data, status, err) {
					console.log(data);
				}
			});
			
			if(updateBeforeProdStatCdChk.prodStatCd==3){
				alert("이미 삭제된 상품 입니다.");
				return false;
			}else if (updateBeforeProdStatCdChk.prodStatCd==null) {
				alert("상품의 상태 확인에 실패하였습니다. 다시 시도해 주세요");
				return false;
			}else {
				return true;
			}
			
		},
	}
	
	
	var page = {
			
			// 페이지 (모바일)
			deleteProdInfo : function () {
				
				
				// 삭제 또는 수정 전, 이미 삭제된 상품인지 상품상태 확인
				if(!updateBeforeProdStatCdChk.prodStatCdChk()){
					return;
				}
				
				if (!confirm("상품을 삭제하시겠습니까?")) {
					return;
				}
				
				var url = "/mobile/salemanage/deleteProdInfo.do";
				
				form.action = url;
				form.submit();
				
			},
			
			
			saveLoading : false,
			// 저장 (모바일)
			saveProdInfo : function () {
				
				// 삭제 또는 수정 전, 이미 삭제된 상품인지 상품상태 확인
				if(!updateBeforeProdStatCdChk.prodStatCdChk()){
					return;
				}
				
					
				// confirm
				if (!confirm("상품정보를 수정하시겠습니까?")) {
					return;
				}
				
				$("input[name=prodTypeCd]").val('${prodDtl.PROD_TYPE_CD}');				// 1:판매, 2:셰어링, 3:나눔
				$("input[name=nProdGbCd]").val(getParam.nProdGbCd()); 				// 10:새상품, 20:미사용, 30:중고상품, 40:전시상품
				$("input[name=dlvWayCd]").val(getParam.dlvWayCd()); 				// 1:제휴택배, 2:일반택배, 5:직거래
				$("input[name=grpRegTypeFlag]").val(getParam.grpRegTypeFlag());		// NEW , OLD
//	 			$("input[name=dlvPayGbCd]").val(getParam.dlvPayGbCd());	// 1:구매자부담, 2:판매자부담
				$("input[name=dlvCmpCd]").val(getParam.dlvCmpCd()); 	// 택배사 코드
				$("input[name=freeShareEndDt]").val($("#freeEndYear").val() + $("#freeEndMonth").val() + $("#freeEndDay").val());

//              alert($("input[name=dlvPayGbCd]").val());

				var formData = new FormData( document.getElementById('form') );
				
				if('${sessionScope.APP}'=='SSOCIO'){
					$("input[name=appYn]").val("Y");
				}
				
				if (page.saveLoading == true) {
					alert('처리중 입니다. 잠시만 기다려 주세요.');	
					return;
				}
				page.saveLoading = true;
				
				$.ajax({
					type: "post",
					async: true,
					url: "/mobile/salemanage/updateProdInfoV2.do",
					dataType:"json",
					data:  formData,
					processData: false,
                    contentType: false,
					success: function(data) {
						
						if (data.rtn.rtnMsgCd == "Y") {
							alert("상품 수정이 완료되었습니다.");

							// 상품 리스트 페이지로 이동
							if('${sessionScope.APP}'=='SSOCIO'){
								var data = '{"PROD_CODE":"'+data.rtn.prodCode+'"}';
								document.location.replace('ssocio://web/prodRegFinish?'+encodeURIComponent(data));
							}else{
								location.href = '/mobile/prod/selectProd.do?PROD_CODE=' + data.rtn.prodCode;
							}
						}
						else {
							alert(data.rtn.rtnMsgCd);
							page.saveLoading = false;
						}
					},
					error: function(data, status, err) {
						console.log(data);
						alert("상품 수정에 실패하였습니다. 다시 시도해 주세요.");
						page.saveLoading = false;
					}
				});
		},
				
	
	
			
			loading : false,
			goNextPage : function () {
			

				$("input[name=prodTypeCd]").val(getParam.prodTypeCd());				// 1:판매, 2:셰어링, 3:나눔
				$("input[name=nProdGbCd]").val(getParam.nProdGbCd()); 				// 10:새상품, 20:미사용, 30:중고상품, 40:전시상품
				$("input[name=dlvWayCd]").val(getParam.dlvWayCd()); 				// 1:제휴택배, 2:일반택배, 5:직거래
				$("input[name=grpRegTypeFlag]").val(getParam.grpRegTypeFlag());		// NEW , OLD
//	 			$("input[name=dlvPayGbCd]").val(getParam.dlvPayGbCd());	// 1:구매자부담, 2:판매자부담
				$("input[name=dlvCmpCd]").val(getParam.dlvCmpCd()); 	// 택배사 코드
				$("input[name=freeShareEndDt]").val($("#freeEndYear").val() + $("#freeEndMonth").val() + $("#freeEndDay").val());
				
				if (getParam.prodTypeCd() == "3") {
					if (!nanumDateValide()){
						return false;
					}
				}
				
				if (this.loading==true) {
					alert('처리중 입니다. 잠시만 기다려 주세요.');	
					return;
				}
				loading = true;
					
				$("form input").each(function(){
					console.log($(this).attr('name'));
				});

				$.ajax({
					type: "post",
					async: true,
					url: "/mobile/salemanage/insertSellProdInfoV2.do",
					dataType:"json",
					data:  $("#form").serialize(),
					success: function(data) {
						
						if (data.rtn.rtnMsgCd == "Y") {
							alert("상품 수정이 완료되었습니다.");

							// 상품 상세 페이지로 이동
							if('${sessionScope.APP}'=='SSOCIO'){
								var data = '{"PROD_CODE":"'+data.rtn.prodCode+'"}';
								document.location.replace('ssocio://web/prodRegFinish?'+encodeURIComponent(data));
							}else{
								location.href = '/mobile/prod/selectProd.do?PROD_CODE=' + data.rtn.prodCode;
							}
						}
						else {
							alert(data.rtn.rtnMsgCd);
						}
					},
					error: function(data, status, err) {
						alert("상품 수정에 실패하였습니다. 다시 시도해 주세요.");
						loading = false;
					}
				});
				
			},
	};




		
	// 우편번호
	function selAddr(gubun,addr,jiben_addr,road_addr){

		
		console.log(gubun+"|"+addr+"|"+jiben_addr+"|"+road_addr);		
		
		
		$('.add_layer').hide(); 
		$('#wrap div#container').show(); 
		 if(gubun == "1"){
				
				$("#ADDR_GB").val(gubun); // 우편번호
				$("#zipCode").val(addr); // 우편번호
				$("#jusoDoro").val(road_addr);
				$("#jusoJiben").val(jiben_addr);
				$("#juso").val(road_addr);
		 }else if(gubun == "2"){
				
			    $("#ADDR_GB").val(gubun); // 우편번호
				$("#zipCode").val(addr); // 우편번호    
				$("#jusoDoro").val(road_addr);
				$("#jusoJiben").val(jiben_addr);
				$("#juso").val(road_addr);
		 }
		popup_hide();
	}	// 우편번호 끝

	

	proc3 = {
			
			
			// 금액관련
			deciChkFnc : function(obj, evt ){
				
				// length 에 맞춰서 자름
				if(evt.type == 'keydown' || evt.type=='keyup'){
					var len = obj.getAttribute('maxlength');
					if(len == null || len == "")
						len = 10;
					
					if(obj.value.length >= len){
						obj.value = obj.value.substring(0,len);
					}
					
					if(obj.value == "") obj.value = 0;
					obj.value=parseInt(obj.value);
				}

			},
			
			
			// FREESHARE_END_DT 셋팅
			setFreeShareEndDt : function(){
				var secDate= '${prodDtl.FREESHARE_END_DT}'  /// 문자열 or  숫자 데이터
				var year = secDate.substr(0,4);
				var month = secDate.substr(4,2);
				var day = secDate.substr(6,2);
				
				$("#freeEndYear").val(year);
				$("#freeEndMonth").val(month);
				$("#freeEndDay").val(day);
			},
			
			
			// 년도
			setYear : function () {
				
				var date = new Date();
				var curYear = date.getFullYear();
				var nextYear = date.getFullYear()+5;
				var yearHtml = "";
				for (var i = curYear ; i < nextYear ; i++) {
					yearHtml += "<option value='";
					yearHtml += i;
					yearHtml += "'>";
					yearHtml += i+"년";
					yearHtml += "</option>";
				}
				$("#freeEndYear").append(yearHtml);
				
			},
			
			// 월
			setMonth : function () {
				
				var date = new Date();
				var curMon = date.getMonth()+1;
				
				if (curMon < 10) {
					curMon = "0"+curMon;
				}
				else {
					curMon = curMon;
				}
				
				$("#freeEndMonth option[value="+curMon+"]").attr("selected", true);	
				
				proc3.setDay();
			},
			
			// 일
			setDay : function () {
				
				var year = $("#freeEndYear option:selected").val();
				var month = $("#freeEndMonth option:selected").val();
				var dayArr = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
				var maxDay = dayArr[month-1];  
				var dayHtml = "";
				
				// 윤년 체크
				if( month==2 &&	( year%4==0 && year%100!=0 || year%400==0 ) ) {
					maxDay = 29;
				}
				
				// 일 set
				$("#freeEndDay").empty();
				dayHtml += "<option value=''>일</option>";
				for (var i = 1 ; i <= maxDay ; i++) {
					dayHtml += "<option value='";
					if (i < 10) {
						dayHtml += "0"+i;
					}
					else {
						dayHtml += i;
					}
					dayHtml += "'>";
					dayHtml += i+"일";
					dayHtml += "</option>";
				}
				$("#freeEndDay").append(dayHtml);
			},
			// 최대이용일 계산
			sharingMaxTerm : function () {
				
				var deposit = Number($("#deposit").val().replace(/,/g, ""));
				var sharingPrice = Number($("#sharingPrice").val().replace(/,/g, ""));

				if (deposit > 0 && sharingPrice > 0) {
					if (deposit < sharingPrice) {
						alert("셰어링금액은 보증금보다 높은 금액으로 입력할 수 없습니다.");
						$("#sharingPrice").val("");
						$("#spanSharingMaxTerm").html(0);
						return;
					}

					// 최대이용일 계산
					var maxTerm = Math.ceil(deposit / sharingPrice);
					$("#spanSharingMaxTerm").text(maxTerm);
					$("#sharingMaxTerm").val(maxTerm);
				}else{
					$("#sharingMaxTerm").val(0);
				}
			
			},

	}
	/**************************************** step3 종료 ***********************************************/
	
	

	// [2015-12-23] 신규추가! 택배사 selectBox 셋팅
	var dlvCmpCdInit = function(){

		// 시퀀스가 존재하는것이 있다면, 시퀀스에 맞게 selected 해주고, 아니면 0번째 것으로 셋팅
		if ($("#dlvCmpSelectEl option[value='${prodDtl.DLV_CMP_CD}']").size() > 0){
			$("#dlvCmpSelectEl").val('${prodDtl.DLV_CMP_CD}');
		}else{
			$("#dlvCmpSelectEl option").eq(0).prop("selected","selected");
		}
	}



	var dlvAmtInit = function(){

		dlvCmpCdInit();
		
		var obj = $("#dlvAmt");
		var readOnly = function (flag){
			if(flag)
				obj.prop('readonly','readonly');
			else
				obj.prop('readonly','');	
		}
		
		readOnly(false);
		
		/*
			ㄱ. 배송방식을 선택했는가
			ㄴ. 판매자 부담인가? ==> 무조건 0원
			ㄷ. 구매자 부담인가?
				1. 제휴택배면, 택배사꺼 가져오기
				2. 일반택배면, 사용자 입력받도록 처리
		*/
		if (getParam.dlvWayCd() == 1 || getParam.dlvWayCd() == 2 || getParam.dlvWayCd() == 4 ){
			
			// 1. 판매자 부담 (무조건 0원)
			if($("input[name=dlvPayGbCd]:checked").val() == 1){
				readOnly(true);
				obj.val(0);
			}
			
			// 2. 구매자 부담
			else if($("input[name=dlvPayGbCd]:checked").val() == 2){
				
				// 1. 제휴택배  (무조건 selec box의 값 참조)
				if(getParam.dlvWayCd() == 1){
					readOnly(true);
					obj.val(parseInt($("#dlvCmpSelectEl option:selected").attr("dlv_amt")));
				}
				// 2. 일반택배
				else if(getParam.dlvWayCd() == 2){
					obj.val('${prodDtl.DLV_PRCE}');
				}
			}
		}else{
			obj.val(0);
		}
	}
	
	

</script>

<c:choose>
	<c:when test="${sessionScope.isPcAgent }">
	<!-- PC화면 -->
		<div class="roc">
			<ul class="inner">
				<li><img src="http://static.ssocio.net/pc/img/common/section/roc_home.png" alt="홈"></li>
				<li>판매관리</li>
			</ul>
		</div>
		<jsp:include page="../common/sale_top.jsp" flush="false" />
		<div class="mype_s_tit">
			<p>배송신청</p>
		</div>
	<!-- //PC화면 -->
	</c:when>
	<c:otherwise>
	<!-- 모바일 화면 -->
		<!-- container -->
		<div id="container">
	<!-- //모바일 화면 -->
	</c:otherwise>
</c:choose>




<form id="form" name="form" method="post" action="" enctype="multipart/form-data">
	<input type="hidden" name="nProdGbCd" value=""/>
	<input type="hidden" name="dlvWayCd" value=""/>
	<input type="hidden" name="dlvCmpCd" value=""/>
	<input type="hidden" name="bndlDlvYn" value=""/>
	<input type="hidden" name="freeShareEndDt" id="freeShareEndDt" value=""/>
<!-- 	<input type="hidden" name="sharingMaxTerm" id="sharingMaxTerm" value=""/> -->
	<input type="hidden" name="grpRegTypeFlag" id="grpRegTypeFlag" value=""/>
	<input type="hidden" name="prodCode" id="prodCode" value="${prodDtl.PROD_CODE }"/>
	<input type="hidden" name="ADDR_GB" id="ADDR_GB" value=""/>
	<input type="hidden" name="jusoDoro" id="jusoDoro" value=""/>
	<input type="hidden" name="jusoJiben" id="jusoJiben" value=""/>
	<input type="hidden" name="prodTypeCd" id="prodTypeCd" value=""/>
	<input type='hidden' name='appYn' value='${sessionScope.APP eq "SSOCIO"? "Y":"N"}'/>
	

<h3 class="title"><strong>
<custom:codeTag groupCode='PROD_TYPE_CD' code='${prodDtl.PROD_TYPE_CD}'/>상품
</strong></h3>

		<div class="contents pic_reg">
        	<div class="purc_area bb0">
				<p class="tit"><span class="bold">필수 등록</span>이미지</p>
                <ul class="pic_reg clear">
                	<li>
                        <div class="essential pic_bx">
                            <img src="${imgList.MAIN_FILE_URL }" class="pure-pic_img" alt="리스트이미지(필수) 이곳을 눌러 사진을 선택해 주세요."  id="mainImg" />
                            
	        		<!-- APP 이 아닌경우의 로직 -->
	        		<c:if test="${sessionScope.APP != 'SSOCIO'}">
	        			<input type="file" id="fileMainImg" style="height:330px;" name="mainImg" accept="image" capture="camera" class="camera_none" onchange="preView(this, 'mainImg', '');proc.procImgSeq('${imgList.MAIN_FILE_SEQ }','mainImg');" />
	        		</c:if>
			        		
<!-- [2015-11-10 추가] 항시 따라 붙는 값 -->
<input type="hidden" id="mainImgFlag" name="mainImgFlag" value="${mainImgFlag }" />
<input type="hidden" id="mainImgSeq" name="mainImgSeq" value="${imgList.MAIN_FILE_SEQ },S" class="imgSeq"/>
<input type="hidden" id="mainImgUrl" name="mainImgUrl" value="${mainImgUrl }" />
			        		
	        		
                        </div>
                    </li>
                	<li>
                        <div class="essential pic_bx">
                            <img src="${imgList.subProdImage[0].SUB_FILE_URL }" class="pure-pic_img" alt="상품이미지1(필수) 이곳을 눌러 사진을 선택해 주세요."  id="subImg1" />
	        			
	        			<!-- APP 이 아닌경우의 로직 -->
	        			<c:if test="${sessionScope.APP != 'SSOCIO'}">
	        				<input type="file" id="fileSubImg1" name="subImg1" accept="image" style="height:89px;" capture="camera" class="camera_none" onchange="javascript:preView(this, 'subImg1', '');proc.procImgSeq('${imgList.subProdImage[0].SUB_FILE_SEQ }','subImg1');" />
	        			</c:if>
		        			
<!-- [2015-11-10 추가] 항시 따라 붙는 값 -->
<input type="hidden" id="subImg1Flag" name="subImg1Flag" value="${subImg1Flag }" />
<input type="hidden" id="subImg1Seq" name="subImg1Seq" value="${imgList.subProdImage[0].SUB_FILE_SEQ },S" class="imgSeq" />
<input type="hidden" id="subImg1Url" name="subImg1Url" value="${subImg1Url }" />	                         
                        </div>
                    </li>
                </ul>
			</div>

        	<div class="purc_area">
				<p class="tit"><span class="bold">선택 등록</span>이미지</p>
                <ul class="lst_other_pic">
                
                
                <!-- 서브이미지 2 -->
                    <li>
                        <div class="pic_bx">
                            <img src="${imgList.subProdImage[1].SUB_FILE_URL }" alt="상품이미지"  id="subImg2" class="pure-pic_img"/>
                            
        				<!-- APP 이 아닌경우의 로직 -->
        				<c:if test="${sessionScope.APP != 'SSOCIO'}">
	        				<input type="file" id="fileSubImg2" name="subImg2" accept="image" style="height:89px;" capture="camera" class="camera_none" onchange="preView(this, 'subImg2', '');proc.procImgSeq('${imgList.subProdImage[1].SUB_FILE_SEQ }','subImg2');" />
						</c:if>
						
                            
							<!-- 삭제 버튼 -->		
		        			<a href="javascript:proc.procDelImg('fileSubImg2','${imgList.subProdImage[1].SUB_FILE_SEQ }','subImg2');" class="pic_del" style="display:
		        				<c:if test="${imgList.subProdImage[1].SUB_FILE_URL eq null or imgList.subProdImage[1].SUB_FILE_URL eq '' }">
	        						none
	        					</c:if>
		        			;"><img src="http://static.ssocio.net/web/images/btn_pic_del.png" alt=""  class="delImg"/>
		        			</a>
		        			

<!-- 항시 따라 붙는 값 -->
<input type="hidden" id="subImg2Flag" name="subImg2Flag" value="${subImg2Flag }" />
<input type="hidden" id="subImg2Seq" name="subImg2Seq" value="${imgList.subProdImage[1].SUB_FILE_SEQ },S"  class="imgSeq"/>
<input type="hidden" id="subImg2Url" name="subImg2Url" value="${subImg2Url }" />
							
						                            
                        </div>
                    </li>
                    
                    <!-- 서브이미지 3-->
                    <li>
                        <div class="pic_bx">
                            <img src="${imgList.subProdImage[2].SUB_FILE_URL  }" alt="상품이미지"  id="subImg3" class="pure-pic_img"/>
                            
        				
						<!-- APP 이 아닌경우의 로직 -->
        				<c:if test="${sessionScope.APP != 'SSOCIO'}">
	        				<input type="file" id="fileSubImg3" name="subImg3" accept="image" style="height:89px;" capture="camera" class="camera_none" onchange="preView(this, 'subImg3', '');proc.procImgSeq('${imgList.subProdImage[2].SUB_FILE_SEQ }','subImg3');" />
	        			</c:if>
		        			
		        			<!-- delImg 표시하기 로직 -->
		        			<!-- 삭제 버튼 -->		
		        			<a href="javascript:proc.procDelImg('fileSubImg3','${imgList.subProdImage[2].SUB_FILE_SEQ }','subImg3');" class="pic_del" style="display:
		        				<c:if test="${imgList.subProdImage[2].SUB_FILE_URL eq null or imgList.subProdImage[2].SUB_FILE_URL eq '' }">
	        						none
	        					</c:if>
		        			;"><img src="http://static.ssocio.net/web/images/btn_pic_del.png" alt=""  class="delImg"/></a>


<!-- 항시 따라 붙는 값 -->
<input type="hidden" id="subImg3Flag" name="subImg3Flag" value="${subImg3Flag }" />
<input type="hidden" id="subImg3Seq" name="subImg3Seq" value="${imgList.subProdImage[2].SUB_FILE_SEQ },S"  class="imgSeq"/>
<input type="hidden" id="subImg3Url" name="subImg3Url" value="${subImg3Url }" />
		        			
		        			
                        </div>
                    </li>
                    
                    <!-- 서브이미지 4 -->
                    <li>
                        <div class="pic_bx">
                            <img src="${imgList.subProdImage[3].SUB_FILE_URL }" alt="상품이미지"  id="subImg4" class="pure-pic_img"/>
                            
        				<!-- APP 이 아닌경우의 로직 -->
        				<c:if test="${sessionScope.APP != 'SSOCIO'}">
<%-- 		        			<input type="file" id="fileSubImg4" name="subImg4" accept="image" style="height:89px;" capture="camera" class="camera_none" onchange="preView(this, 'subImg4', '');proc.delImgShow(this);proc.procImgSeq('${imgList.subProdImage[3].SUB_FILE_SEQ }','subImg4');" /> --%>
	        			<input type="file" id="fileSubImg4" name="subImg4" accept="image" style="height:89px;" capture="camera" class="camera_none" onchange="preView(this, 'subImg4', '');proc.procImgSeq('${imgList.subProdImage[3].SUB_FILE_SEQ }','subImg4');" />
	        			
	        			</c:if>
		        			
		        			<!-- delImg 표시하기 로직 -->
	        			<a href="javascript:proc.procDelImg('fileSubImg4','${imgList.subProdImage[3].SUB_FILE_SEQ }','subImg4');" class="pic_del" style="display:
	        				<c:if test="${imgList.subProdImage[3].SUB_FILE_URL eq null or imgList.subProdImage[3].SUB_FILE_URL eq '' }">
        						none
        					</c:if>
	        			;"><img src="http://static.ssocio.net/web/images/btn_pic_del.png" alt="" class="delImg"/></a>

<!-- 항시 따라 붙는 값 -->
<input type="hidden" id="subImg4Flag" name="subImg4Flag" value="${subImg4Flag }" />
<input type="hidden" id="subImg4Seq" name="subImg4Seq" value="${imgList.subProdImage[3].SUB_FILE_SEQ },S"  class="imgSeq" />
<input type="hidden" id="subImg4Url" name="subImg4Url" value="${subImg4Url }" />   
		        			
		        			
                        </div>
                    </li>
                    
                    
                    <!-- 서브이미지 5 -->
                    <li>
                        <div class="pic_bx">
                            <img src="${imgList.subProdImage[4].SUB_FILE_URL }" alt="상품이미지"  id="subImg5" class="pure-pic_img"/>
                            
            				<!-- APP 이 아닌경우의 로직 -->
        				<c:if test="${sessionScope.APP != 'SSOCIO'}">
	        				<input type="file" id="fileSubImg5" name="subImg5" accept="image" style="height:89px;" capture="camera" class="camera_none" onchange="preView(this, 'subImg5', '');proc.procImgSeq('${imgList.subProdImage[4].SUB_FILE_SEQ }','subImg5');" />
	        			</c:if>
		        			
		        			<!-- delImg 표시하기 로직 -->
	        			<a href="javascript:proc.procDelImg('fileSubImg5','${imgList.subProdImage[4].SUB_FILE_SEQ }','subImg5');" class="pic_del" style="display:
	        				<c:if test="${imgList.subProdImage[4].SUB_FILE_URL eq null or imgList.subProdImage[5].SUB_FILE_URL eq '' }">
        						none
        					</c:if>
	        			;"><img src="http://static.ssocio.net/web/images/btn_pic_del.png" alt=""  class="delImg"/></a>
	        			
	        			
<!-- 항시 따라 붙는 값 -->
<input type="hidden" id="subImg5Flag" name="subImg5Flag" value="${subImg5Flag }" />
<input type="hidden" id="subImg5Seq" name="subImg5Seq" value="${imgList.subProdImage[4].SUB_FILE_SEQ },S"  class="imgSeq" />
<input type="hidden" id="subImg5Url" name="subImg5Url" value="${subImg5Url }" />   
		        			
		        			
                        </div>
                    </li>
                </ul>
			</div>
<!-- ---------------------------------------  step1 종료 --------------------------------------- -->





<!-- ---------------------------------------  step2 시작 --------------------------------------- -->
        	<div class="purc_area">
				<p class="tit"><span class="bold">상품명</span>을 입력해 주세요.</p>
				<ul class="mt10">
	                <li>
	                	<div class="input_text">
	                        <input type="text" name="prodNm" id="prodNm" value="${prodDtl.PROD_NM }">
	                        <a href="javascript:void(0);"><img onclick="proc2.prodNmDel()" src="http://static.ssocio.net/web/images/ico_del.png" alt="삭제"></a>
	                        <span class="byte type" id="spanProdNmLen">0/50byte</span>
	                    </div>
	                </li>
	            </ul>
			</div>
        	
        	<div class="purc_area">
				<p class="tit"><span class="bold">상품설명</span>을 입력해 주세요.</p>
				<ul class="mt10">
                <li>
                	<div class="text_box">
                        <textarea name="prodDtl" id="prodDtl">${prodDtl.PROD_MB_DTL }</textarea>
                        <span class="byte type" id="spanProdDtlLen">0/500byte</span>
                    </div>
                </li>
            </ul>
			</div>
<!-- ---------------------------------------  step2 종료 --------------------------------------- -->


			<div class="purc_area"  id="nProdGbCdArea">
				<p class="tit"><span class="bold">판매상품의 상태</span>를 선택해주세요.</p>
				<ul class="list-tab sell-nProd mt10" id="nProdGbCd">
					<li ${prodDtl.NPROD_GB_CD eq 30? 'class="active"':'' }><a href="#">중고</a></li>
					<li ${prodDtl.NPROD_GB_CD eq 10? 'class="active"':'' }><a href="#">새상품</a></li>
					<li ${prodDtl.NPROD_GB_CD eq 20? 'class="active"':'' }><a href="#">미사용</a></li>
					<li ${prodDtl.NPROD_GB_CD eq 40? 'class="active"':'' }><a href="#">전시상품</a></li>
				</ul>
				<div class="tooltip  ${prodDtl.NPROD_GB_CD eq 30?  'active':'' }">
                    <p class="arrow"></p>
                    <p class="box"><strong>상품을 사용한 상태 입니다.</strong></p>
                </div>
                <div class="tooltip ${prodDtl.NPROD_GB_CD eq 10?  'active':'' }">
                    <p class="arrow"></p>
                    <p class="box"><strong>포장도 뜯지 않은 상태 입니다.</strong></p>
                </div>
                <div class="tooltip ${prodDtl.NPROD_GB_CD eq 20?  'active':'' }">
                    <p class="arrow"></p>
                    <p class="box"><strong>포장은 뜯은 상태이나 실사용은 하지 않은 상태 입니다.</strong></p>
                </div>
                <div class="tooltip ${prodDtl.NPROD_GB_CD eq 40?  'active':'' }">
                    <p class="arrow"></p>
                    <p class="box"><strong>전시된 상품입니다.</strong></p>
                </div>
			</div>
			
			<div class="purc_area" id="sellDiv" style="display:${prodDtl.PROD_TYPE_CD eq 1? 'block':'none'}">
				<p class="tit"><span class="bold">판매금액</span>을 입력해주세요. <span class="txt">(숫자만 입력 가능)</span></p>
				<div class="tbl type4">
	            	<table class="tbl-data">
	                	<colgroup>
	                    	<col width="*">
	                    	<col width="20px">
	                    </colgroup>
	                    <tbody>
	                    	<tr>
	                            <td class="pd5"><input name="sellPrce" type="number"  value="${prodDtl.SELL_PRCE }" class="numType" maxlength="8" pattern="[0-9]*"></td>
	                            <td class="tr">원</td>
	                        </tr>
	                    </tbody>
	                </table>
	            </div>
			</div>
			
			<div class="purc_area"  id="sharDiv" style="display:${prodDtl.PROD_TYPE_CD eq 2? 'block':'none'}">
	            <p class="tit"><span class="bold">보증금과 셰어링 금액</span>을 입력해주세요. <span class="txt">(숫자만 입력 가능)</span></p>
	            <div class="tbl type4 none-bg">
	                <table class="tbl-data tbl-deposit">
	                    <colgroup>
	                        <col width="30%">
	                        <col width="*">
	                        <col width="20px">
	                    </colgroup>
	                    <tbody>
	                        <tr>
	                            <th>보증금<br/><span>(판매가)</span></th>
	                            <td class="pd5">
	                            <input name="deposit" value="${shareDtl.DEPOSIT }" id="deposit" maxlength="8" type="number" class="deposit_num numType"  placeholder="보증금을 입력하여 주세요." pattern="[0-9]*">
	                            </td>
	                            <td class="tr">원</td>
	                        </tr>
	                        <tr class="tool_deposit">
	                            <td colspan="3">
	                                <div class="tooltip">
	                                    <p class="arrow"></p>
	                                    <p class="box"><strong>보증금은 셰어링하고자 하는 제품의 중고가(판매가)를 적용하여 주시기 바랍니다.</strong></p>
	                                </div>
	                            </td>
	                        </tr>
	                        <tr>
	                            <th>셰어링 금액<br/><span>(1일)</span></th>
	                            <td class="pd5"><input name="sharingPrice" value="${shareDtl.SHARING_PRICE }" id="sharingPrice" maxlength="8" type="number" pattern="[0-9]*"></td>
	                            <td class="tr">원</td>
	                        </tr>
	                        <tr>
	                            <th></th>
	                            <td colspan="2">
	                                <div class="tbl_inner_bx">
	                                    <span class="fl discount">셰어링 최대 이용 기간 
	                                    	<span id="spanSharingMaxTerm">${shareDtl.SHARING_MAX_TERM  }</span>일
	                                    </span>
	                                </div>
	                            </td>
	                        </tr>
	                    </tbody>
	                </table>
	            </div>
	        </div>
			
			 <!-- 나눔 신청시에만 보이는 layout -->
	        <div class="purc_area" style="display:${prodDtl.PROD_TYPE_CD eq 3? 'block':'none'}" id="nanumDiv">
	            <p class="tit"><span class="bold">나눔 신청 종료일</span>를 설정해 주세요.<br/><span class="txt">(신청시작일은 오늘입니다.)</span></p>
	            <ul class="list-sel mt10">
	                <li>
	                    <select id="freeEndYear" name="freeEndYear">
	                    	<option value="">년도</option>
	                    </select>
	                </li>
	                <li>
	                    <select id="freeEndMonth" name="freeEndMonth">
	                    	<option value="">월</option>
	                    	<option value="01">1월</option>
	                    	<option value="02">2월</option>
	                    	<option value="03">3월</option>
	                    	<option value="04">4월</option>
	                    	<option value="05">5월</option>
	                    	<option value="06">6월</option>
	                    	<option value="07">7월</option>
	                    	<option value="08">8월</option>
	                    	<option value="09">9월</option>
	                    	<option value="10">10월</option>
	                    	<option value="11">11월</option>
	                    	<option value="12">12월</option>
	                    </select>
	                </li>
	                <li>
	                    <select id="freeEndDay" name="freeEndDay">
		                   	<option value="">일</option>
		                 </select>
	                </li>
	            </ul>
	        </div>
			
			
			
			<div class="purc_area" id="dlvWayCdArea">
			<!-- share_ship-type ,  sell-prod-->
				<p class="tit"><span class="bold">배송 방식</span>을 선택해주세요.</p>
				<ul class="list-tab sell-prod mt10" id="dlvWayCd">
					<li ${prodDtl.DLV_WAY_CD eq 1? 'class="active"':'' }><a href="">제휴택배</a></li>
					<li ${prodDtl.DLV_WAY_CD eq 2? 'class="active"':'' }><a href="">일반택배</a></li>
					<li ${prodDtl.DLV_WAY_CD eq 3? 'class="active"':'' }><a href="">우편/등기</a></li>
					<li ${prodDtl.DLV_WAY_CD eq 4? 'class="active"':'' }><a href="">퀵서비스</a></li>
					<li ${prodDtl.DLV_WAY_CD eq 5? 'class="active"':'' }><a href="">직거래</a></li>
				</ul>
				<p id="sharTipText" class="txt-type mt10 ml10" style="display: ${prodDtl.PROD_TYPE_CD eq 2? 'block':'none'}">* 셰어링 상품은 제휴택배만 이용이 가능합니다.</p>
			</div>
			
			<!-- 
			$("#dlvTitArea").hide();
			$("#dlvCmpArea").hide();
			$("#dlvAmtArea").hide();
			 -->
			
			
			<div class="purc_area" id="dlvWayDlv">
				<p class="tit" id="dlvTitArea"><span class="bold">택배사</span>를 선택해주세요.</p>
				<ul class="mt10" id="dlvCmpArea">
	                <li>
	                	<select id="dlvCmpSelectEl">
	            		</select>
					</li>
	            </ul>

            <c:choose>
                <c:when test="${empty prodDtl.PROD_CODE || prodDtl.PROD_TYPE_CD == 1 || prodDtl.PROD_TYPE_CD == 2}">
	            <ul class="mt10" >
	                <li>
	                <input id="rd1" type="radio" name="dlvPayGbCd"  value="2"  ${prodDtl.DLV_PAY_GB_CD eq 2||prodDtl.DLV_PAY_GB_CD eq null ? 'checked="checked"':'' }/><label for="rd1">구매자 부담</label>

	                <input id="rd2" type="radio" name="dlvPayGbCd" value="1" class="ml10"   ${prodDtl.DLV_PAY_GB_CD eq 1? 'checked="checked"':'' }/><label for="rd2">판매자 부담</label>
	                </li>
	            </ul>
                </c:when>
                <c:otherwise>
                    <input type="hidden" name="dlvPayGbCd" value="2">
                </c:otherwise>
            </c:choose>

	            <div class="tbl type4" id="dlvAmtArea">
               <c:if test="${empty prodDtl.PROD_CODE || prodDtl.PROD_TYPE_CD == 1 || prodDtl.PROD_TYPE_CD == 2}">

	            	<table class="tbl-data" >
	                	<colgroup>
	                		<col width="15%">
	                    	<col width="*">
	                    	<col width="20px">
	                    </colgroup>
	                    <tbody>
	                    	<tr>
	                    		<th>배송비</th>
	                            <td class="pd5"><input value="${prodDtl.DLV_PRCE }" type="text" name="dlvAmt" id="dlvAmt" class="tr" maxlength="8"></td>
	                            <td class="tr">원</td>
	                        </tr>
	                    </tbody>
	                </table>
               </c:if>	 

	            </div>
			</div>
			
			
			<div class="purc_area" id="dlvWayCdOffLine">
				<p class="tit"><span class="bold">거래가능 지역</span>을 입력해 주세요.</p>
				<ul class="mt10">
	                <li><input type="text" maxlength="100" name="tradLocOffLine" value="${prodDtl.TRAD_LOC }" placeholder="ex) 서울시 강남구 대치동" /></li>
	            </ul>
			</div>
			
			<div class="purc_area" id="dlvWayCdQuick">
				<p class="tit"><span class="bold">배송가능 지역</span>을 입력해 주세요.</p>
				<ul class="mt10">
	                <li><input type="text" maxlength="100" name="tradLocQuick" value="${prodDtl.TRAD_LOC }" placeholder="ex) 서울 전지역" /></li>
	            </ul>
			</div>
			
			<!-- 판매자 주소 선택 -->
			<div id="oldGrp" class="purc_area sell_addr_bx" style="display: ${myDlvList ne null? 'block':'none'} ">
				<p class="tit"><span class="bold">판매자 주소를</span>를 선택해 주세요.</p>
				<ul class="mt10">
	                <li>
	                	<select id="sellerGrpSelectEl" name="grpProdSeq">
          					<c:forEach var="list" items="${myDlvList}" varStatus="status">
        						<option ${list.GRP_PROD_SEQ eq prodDtl.GRP_PROD_SEQ? 'selected':'' } value="${list.GRP_PROD_SEQ}" id="[${list.ZIP_CD}] ${list.CUST_ADDR} ${list.JUSO_DTL}">${list.GRP_NM}</option>
				      		</c:forEach>
	            		</select>
					</li>
	            </ul>
	            <div class="info">
		            <div class="basic_addr mt10" id="addrView" ></div>
		            <p class="txt-type mt10">* 판매자 주소 수정은 '마이페이지 > 판매관리 > 출하지 관리' 에서 가능합니다.</p>
	            </div>
	            <a href="javascript:$('#oldGrp').hide();$('#newGrp').show();" class="ico_write">새로 입력</a>
			</div>
			<!-- 판매자 주소 선택 -->
			
			<!-- 판매자 주소 입력 -->
			<div id="newGrp" class="purc_area bb0" style="display:  ${myDlvList eq null? 'block':'none'}">
				<p class="tit"><span class="bold">판매자 주소</span>를 입력해 주세요.</p>
				<ul class="add mt10">
	                <li><input type="text" id="zipCode" name="zipCode" class="fl" readonly="readonly"> <a href="javascript:postShow()" class="btn_b fr">우편번호</a></li>
	                <li><input type="text" id="juso" name="juso" readonly="readonly"></li>
	                <li><input type="text" id="jusoDtl" name="jusoDtl" maxlength="100" placeholder="상세 주소 입력"></li>
	            </ul>
	            
	            <c:if test="${myDlvList ne null }">
	            	<a href="javascript:$('#oldGrp').show();$('#newGrp').hide();" class="ico_write">주소 선택</a>
	            </c:if>
			</div>
			<!-- 판매자 주소 입력 -->
		
		
		</div>


		<div class="btn_enter">
			<ul>
				<li><a href="javascript:page.saveProdInfo();" class="btn_r">수정</a></li>
				<li><a href="javascript:page.deleteProdInfo();" class="btn_b-line">삭제</a></li>
			</ul>
		</div>


</form>

<c:choose>
	<c:when test="${sessionScope.isPcAgent }">
	<!-- PC화면 -->
		<jsp:include page="../common/sale_bottom.jsp" flush="false" />
	<!-- //PC화면 -->
	</c:when>
	<c:otherwise>
	<!-- 모바일 화면 -->
		    </div>
		    <!-- //container -->
	<!-- //모바일 화면 -->
	</c:otherwise>
</c:choose>