<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="adminStatisMapper">

	<select id="selectSignupStatis" parameterType="HashMap" resultType="HashMap">
		SELECT 	
				M.TIME
		,		SUM(M.MWA_SGN_O_CNT + M.MWI_SGN_O_CNT + M.MW_SGN_O_CNT) MW_SGN_O_CNT
<!-- 		,		SUM(M.MWA_SGN_O_CNT) MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.MWI_SGN_O_CNT) MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.MW_SGN_O_CNT) MW_SGN_O_CNT -->
		,		SUM(M.MWA_SGN_S_P_CNT + M.MWA_SGN_S_C_CNT + M.MWI_SGN_S_P_CNT + M.MWI_SGN_S_C_CNT + M.MW_SGN_S_P_CNT + M.MW_SGN_S_C_CNT) MW_SGN_S_CNT
<!-- 		,		SUM(M.MWA_SGN_S_P_CNT) MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWA_SGN_S_C_CNT) MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_P_CNT) MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_C_CNT) MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_P_CNT) MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_C_CNT) MW_SGN_S_C_CNT -->
		,		SUM(M.MAA_SGN_O_CNT + M.MAI_SGN_O_CNT) MA_SGN_O_CNT
<!-- 		,		SUM(M.MAA_SGN_O_CNT) MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.MAI_SGN_O_CNT) MAI_SGN_O_CNT -->
		,		SUM(M.MAA_SGN_S_P_CNT + M.MAA_SGN_S_P_CNT + M.MAI_SGN_S_P_CNT + M.MAI_SGN_S_C_CNT) MA_SGN_S_CNT
<!-- 		,		SUM(M.MAA_SGN_S_P_CNT) MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAA_SGN_S_C_CNT) MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_P_CNT) MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_C_CNT) MAI_SGN_S_C_CNT -->
		,		SUM(M.PW_SGN_O_CNT) PW_SGN_O_CNT
		,		SUM(M.PW_SGN_S_P_CNT + M.PW_SGN_S_C_CNT) PW_SGN_S_CNT
<!-- 		,		SUM(M.PW_SGN_S_P_CNT) PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.PW_SGN_S_C_CNT) PW_SGN_S_C_CNT -->

		,		SUM(M.LAST_MWA_SGN_O_CNT + M.LAST_MWI_SGN_O_CNT + M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_O_CNT) LAST_MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_O_CNT) LAST_MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT -->
		,		SUM(M.LAST_MWA_SGN_S_P_CNT + M.LAST_MWA_SGN_S_C_CNT + M.LAST_MWI_SGN_S_P_CNT + M.LAST_MWI_SGN_S_C_CNT + M.LAST_MW_SGN_S_P_CNT + M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_S_P_CNT) LAST_MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWA_SGN_S_C_CNT) LAST_MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_P_CNT) LAST_MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_C_CNT) LAST_MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_P_CNT) LAST_MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_C_CNT -->
		,		SUM(M.LAST_MAA_SGN_O_CNT + M.LAST_MAI_SGN_O_CNT) LAST_MA_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_O_CNT) LAST_MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_O_CNT) LAST_MAI_SGN_O_CNT -->
		,		SUM(M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAI_SGN_S_P_CNT + M.LAST_MAI_SGN_S_C_CNT) LAST_MA_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_S_P_CNT) LAST_MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAA_SGN_S_C_CNT) LAST_MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_P_CNT) LAST_MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_C_CNT) LAST_MAI_SGN_S_C_CNT -->
		,		SUM(M.LAST_PW_SGN_O_CNT) LAST_PW_SGN_O_CNT
		,		SUM(M.LAST_PW_SGN_S_P_CNT + M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_PW_SGN_S_P_CNT) LAST_PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_C_CNT -->
	FROM (
		SELECT		REF.TIME TIME
			,		NVL(A.MAA_SGN_O_CNT, 0) MAA_SGN_O_CNT
			,		NVL(A.MAA_SGN_S_C_CNT, 0) MAA_SGN_S_C_CNT
			,		NVL(A.MAA_SGN_S_P_CNT, 0) MAA_SGN_S_P_CNT
			,		NVL(A.MAI_SGN_O_CNT, 0) MAI_SGN_O_CNT
			,		NVL(A.MAI_SGN_S_C_CNT, 0) MAI_SGN_S_C_CNT
			,		NVL(A.MAI_SGN_S_P_CNT, 0) MAI_SGN_S_P_CNT
			,		NVL(A.MW_SGN_O_CNT, 0) MW_SGN_O_CNT
			,		NVL(A.MW_SGN_S_C_CNT, 0) MW_SGN_S_C_CNT
			,		NVL(A.MW_SGN_S_P_CNT, 0) MW_SGN_S_P_CNT
			,		NVL(A.MWA_SGN_O_CNT, 0) MWA_SGN_O_CNT
			,		NVL(A.MWA_SGN_S_C_CNT, 0) MWA_SGN_S_C_CNT
			,		NVL(A.MWA_SGN_S_P_CNT, 0) MWA_SGN_S_P_CNT
			,		NVL(A.MWI_SGN_O_CNT, 0) MWI_SGN_O_CNT
			,		NVL(A.MWI_SGN_S_C_CNT, 0) MWI_SGN_S_C_CNT
			,		NVL(A.MWI_SGN_S_P_CNT, 0) MWI_SGN_S_P_CNT
			,		NVL(A.PW_SGN_O_CNT, 0) PW_SGN_O_CNT
			,		NVL(A.PW_SGN_S_C_CNT, 0) PW_SGN_S_C_CNT
			,		NVL(A.PW_SGN_S_P_CNT, 0) PW_SGN_S_P_CNT
			,		NVL(B.MAA_SGN_O_CNT, 0) LAST_MAA_SGN_O_CNT
			,		NVL(B.MAA_SGN_S_C_CNT, 0) LAST_MAA_SGN_S_C_CNT
			,		NVL(B.MAA_SGN_S_P_CNT, 0) LAST_MAA_SGN_S_P_CNT
			,		NVL(B.MAI_SGN_O_CNT, 0) LAST_MAI_SGN_O_CNT
			,		NVL(B.MAI_SGN_S_C_CNT, 0) LAST_MAI_SGN_S_C_CNT
			,		NVL(B.MAI_SGN_S_P_CNT, 0) LAST_MAI_SGN_S_P_CNT
			,		NVL(B.MW_SGN_O_CNT, 0) LAST_MW_SGN_O_CNT
			,		NVL(B.MW_SGN_S_C_CNT, 0) LAST_MW_SGN_S_C_CNT
			,		NVL(B.MW_SGN_S_P_CNT, 0) LAST_MW_SGN_S_P_CNT
			,		NVL(B.MWA_SGN_O_CNT, 0) LAST_MWA_SGN_O_CNT
			,		NVL(B.MWA_SGN_S_C_CNT, 0) LAST_MWA_SGN_S_C_CNT
			,		NVL(B.MWA_SGN_S_P_CNT, 0) LAST_MWA_SGN_S_P_CNT
			,		NVL(B.MWI_SGN_O_CNT, 0) LAST_MWI_SGN_O_CNT
			,		NVL(B.MWI_SGN_S_C_CNT, 0) LAST_MWI_SGN_S_C_CNT
			,		NVL(B.MWI_SGN_S_P_CNT, 0) LAST_MWI_SGN_S_P_CNT
			,		NVL(B.PW_SGN_O_CNT, 0) LAST_PW_SGN_O_CNT
			,		NVL(B.PW_SGN_S_C_CNT, 0) LAST_PW_SGN_S_C_CNT
			,		NVL(B.PW_SGN_S_P_CNT, 0) LAST_PW_SGN_S_P_CNT
		FROM (SELECT 		#{date} YMD
			, 	TO_CHAR(TO_DATE(#{date}, 'YYMMDD') - 1, 'YYMMDD') B_YMD
			,	TIME
				FROM (SELECT LPAD((LEVEL - 1),2,'0') TIME FROM DUAL CONNECT BY LEVEL &lt;= 24)
			) REF
		LEFT OUTER JOIN STATIS_SGN_TIME A
		ON      REF.TIME = A.S_TIME
		AND    REF.YMD = A.YMD
		LEFT OUTER JOIN STATIS_SGN_TIME B
		ON       REF.TIME = B.S_TIME 
		AND    REF.B_YMD = B.YMD
		WHERE REF.YMD = #{date}
		) M
		GROUP BY ROLLUP(M.TIME)
	</select>
	
	<select id="selectSignupWeekStatis" parameterType="HashMap" resultType="HashMap">
		SELECT 	
					M.YMD
			,		SUM(M.MWA_SGN_O_CNT + M.MWI_SGN_O_CNT + M.MW_SGN_O_CNT) MW_SGN_O_CNT
<!-- 		,		SUM(M.MWA_SGN_O_CNT) MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.MWI_SGN_O_CNT) MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.MW_SGN_O_CNT) MW_SGN_O_CNT -->
		,		SUM(M.MWA_SGN_S_P_CNT + M.MWA_SGN_S_C_CNT + M.MWI_SGN_S_P_CNT + M.MWI_SGN_S_C_CNT + M.MW_SGN_S_P_CNT + M.MW_SGN_S_C_CNT) MW_SGN_S_CNT
<!-- 		,		SUM(M.MWA_SGN_S_P_CNT) MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWA_SGN_S_C_CNT) MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_P_CNT) MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_C_CNT) MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_P_CNT) MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_C_CNT) MW_SGN_S_C_CNT -->
		,		SUM(M.MAA_SGN_O_CNT + M.MAI_SGN_O_CNT) MA_SGN_O_CNT
<!-- 		,		SUM(M.MAA_SGN_O_CNT) MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.MAI_SGN_O_CNT) MAI_SGN_O_CNT -->
		,		SUM(M.MAA_SGN_S_P_CNT + M.MAA_SGN_S_P_CNT + M.MAI_SGN_S_P_CNT + M.MAI_SGN_S_C_CNT) MA_SGN_S_CNT
<!-- 		,		SUM(M.MAA_SGN_S_P_CNT) MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAA_SGN_S_C_CNT) MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_P_CNT) MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_C_CNT) MAI_SGN_S_C_CNT -->
		,		SUM(M.PW_SGN_O_CNT) PW_SGN_O_CNT
		,		SUM(M.PW_SGN_S_P_CNT + M.PW_SGN_S_C_CNT) PW_SGN_S_CNT
<!-- 		,		SUM(M.PW_SGN_S_P_CNT) PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.PW_SGN_S_C_CNT) PW_SGN_S_C_CNT -->

		,		SUM(M.LAST_MWA_SGN_O_CNT + M.LAST_MWI_SGN_O_CNT + M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_O_CNT) LAST_MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_O_CNT) LAST_MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT -->
		,		SUM(M.LAST_MWA_SGN_S_P_CNT + M.LAST_MWA_SGN_S_C_CNT + M.LAST_MWI_SGN_S_P_CNT + M.LAST_MWI_SGN_S_C_CNT + M.LAST_MW_SGN_S_P_CNT + M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_S_P_CNT) LAST_MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWA_SGN_S_C_CNT) LAST_MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_P_CNT) LAST_MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_C_CNT) LAST_MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_P_CNT) LAST_MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_C_CNT -->
		,		SUM(M.LAST_MAA_SGN_O_CNT + M.LAST_MAI_SGN_O_CNT) LAST_MA_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_O_CNT) LAST_MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_O_CNT) LAST_MAI_SGN_O_CNT -->
		,		SUM(M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAI_SGN_S_P_CNT + M.LAST_MAI_SGN_S_C_CNT) LAST_MA_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_S_P_CNT) LAST_MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAA_SGN_S_C_CNT) LAST_MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_P_CNT) LAST_MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_C_CNT) LAST_MAI_SGN_S_C_CNT -->
		,		SUM(M.LAST_PW_SGN_O_CNT) LAST_PW_SGN_O_CNT
		,		SUM(M.LAST_PW_SGN_S_P_CNT + M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_PW_SGN_S_P_CNT) LAST_PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_C_CNT -->
		FROM (
			SELECT	SRD.YMD
				,		NVL(A.MAA_SGN_O_CNT, 0) MAA_SGN_O_CNT
				,		NVL(A.MAA_SGN_S_C_CNT, 0) MAA_SGN_S_C_CNT
				,		NVL(A.MAA_SGN_S_P_CNT, 0) MAA_SGN_S_P_CNT
				,		NVL(A.MAI_SGN_O_CNT, 0) MAI_SGN_O_CNT
				,		NVL(A.MAI_SGN_S_C_CNT, 0) MAI_SGN_S_C_CNT
				,		NVL(A.MAI_SGN_S_P_CNT, 0) MAI_SGN_S_P_CNT
				,		NVL(A.MW_SGN_O_CNT, 0) MW_SGN_O_CNT
				,		NVL(A.MW_SGN_S_C_CNT, 0) MW_SGN_S_C_CNT
				,		NVL(A.MW_SGN_S_P_CNT, 0) MW_SGN_S_P_CNT
				,		NVL(A.MWA_SGN_O_CNT, 0) MWA_SGN_O_CNT
				,		NVL(A.MWA_SGN_S_C_CNT, 0) MWA_SGN_S_C_CNT
				,		NVL(A.MWA_SGN_S_P_CNT, 0) MWA_SGN_S_P_CNT
				,		NVL(A.MWI_SGN_O_CNT, 0) MWI_SGN_O_CNT
				,		NVL(A.MWI_SGN_S_C_CNT, 0) MWI_SGN_S_C_CNT
				,		NVL(A.MWI_SGN_S_P_CNT, 0) MWI_SGN_S_P_CNT
				,		NVL(A.PW_SGN_O_CNT, 0) PW_SGN_O_CNT
				,		NVL(A.PW_SGN_S_C_CNT, 0) PW_SGN_S_C_CNT
				,		NVL(A.PW_SGN_S_P_CNT, 0) PW_SGN_S_P_CNT
				,		NVL(B.MAA_SGN_O_CNT, 0) LAST_MAA_SGN_O_CNT
				,		NVL(B.MAA_SGN_S_C_CNT, 0) LAST_MAA_SGN_S_C_CNT
				,		NVL(B.MAA_SGN_S_P_CNT, 0) LAST_MAA_SGN_S_P_CNT
				,		NVL(B.MAI_SGN_O_CNT, 0) LAST_MAI_SGN_O_CNT
				,		NVL(B.MAI_SGN_S_C_CNT, 0) LAST_MAI_SGN_S_C_CNT
				,		NVL(B.MAI_SGN_S_P_CNT, 0) LAST_MAI_SGN_S_P_CNT
				,		NVL(B.MW_SGN_O_CNT, 0) LAST_MW_SGN_O_CNT
				,		NVL(B.MW_SGN_S_C_CNT, 0) LAST_MW_SGN_S_C_CNT
				,		NVL(B.MW_SGN_S_P_CNT, 0) LAST_MW_SGN_S_P_CNT
				,		NVL(B.MWA_SGN_O_CNT, 0) LAST_MWA_SGN_O_CNT
				,		NVL(B.MWA_SGN_S_C_CNT, 0) LAST_MWA_SGN_S_C_CNT
				,		NVL(B.MWA_SGN_S_P_CNT, 0) LAST_MWA_SGN_S_P_CNT
				,		NVL(B.MWI_SGN_O_CNT, 0) LAST_MWI_SGN_O_CNT
				,		NVL(B.MWI_SGN_S_C_CNT, 0) LAST_MWI_SGN_S_C_CNT
				,		NVL(B.MWI_SGN_S_P_CNT, 0) LAST_MWI_SGN_S_P_CNT
				,		NVL(B.PW_SGN_O_CNT, 0) LAST_PW_SGN_O_CNT
				,		NVL(B.PW_SGN_S_C_CNT, 0) LAST_PW_SGN_S_C_CNT
				,		NVL(B.PW_SGN_S_P_CNT, 0) LAST_PW_SGN_S_P_CNT
			FROM STATIS_REF_DATE SRD
				LEFT OUTER JOIN STATIS_SGN_DATE A
				ON SRD.S_YEAR = A.S_YEAR
				AND SRD.S_MONTH = A.S_MONTH
				AND SRD.S_DATE = A.S_DATE
				LEFT OUTER JOIN STATIS_SGN_DATE B	
				ON SRD.YMD = TO_CHAR(TO_DATE(B.S_YEAR||B.S_MONTH||B.S_DATE,'YYYYMMDD') -7,'YYYYMMDD')
			WHERE SRD.YMD BETWEEN #{date} AND #{last_date}
			) M
			GROUP BY ROLLUP(M.YMD)
	</select>




	<select id="selectSignupWhDayStatis" parameterType="HashMap" resultType="HashMap">
		SELECT 	
					TO_CHAR(TO_DATE(M.YMD, 'YYYY-MM-DD'), 'YYYY-MM-DD') AS YMD
			,		SUM(M.MWA_SGN_O_CNT + M.MWI_SGN_O_CNT + M.MW_SGN_O_CNT) MW_SGN_O_CNT
<!-- 		,		SUM(M.MWA_SGN_O_CNT) MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.MWI_SGN_O_CNT) MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.MW_SGN_O_CNT) MW_SGN_O_CNT -->
		,		SUM(M.MWA_SGN_S_P_CNT + M.MWA_SGN_S_C_CNT + M.MWI_SGN_S_P_CNT + M.MWI_SGN_S_C_CNT + M.MW_SGN_S_P_CNT + M.MW_SGN_S_C_CNT) MW_SGN_S_CNT
<!-- 		,		SUM(M.MWA_SGN_S_P_CNT) MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWA_SGN_S_C_CNT) MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_P_CNT) MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_C_CNT) MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_P_CNT) MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_C_CNT) MW_SGN_S_C_CNT -->
		,		SUM(M.MAA_SGN_O_CNT + M.MAI_SGN_O_CNT) MA_SGN_O_CNT
<!-- 		,		SUM(M.MAA_SGN_O_CNT) MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.MAI_SGN_O_CNT) MAI_SGN_O_CNT -->
		,		SUM(M.MAA_SGN_S_P_CNT + M.MAA_SGN_S_P_CNT + M.MAI_SGN_S_P_CNT + M.MAI_SGN_S_C_CNT) MA_SGN_S_CNT
<!-- 		,		SUM(M.MAA_SGN_S_P_CNT) MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAA_SGN_S_C_CNT) MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_P_CNT) MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_C_CNT) MAI_SGN_S_C_CNT -->
		,		SUM(M.PW_SGN_O_CNT) PW_SGN_O_CNT
		,		SUM(M.PW_SGN_S_P_CNT + M.PW_SGN_S_C_CNT) PW_SGN_S_CNT
<!-- 		,		SUM(M.PW_SGN_S_P_CNT) PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.PW_SGN_S_C_CNT) PW_SGN_S_C_CNT -->

		,		SUM(M.LAST_MWA_SGN_O_CNT + M.LAST_MWI_SGN_O_CNT + M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_O_CNT) LAST_MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_O_CNT) LAST_MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT -->
		,		SUM(M.LAST_MWA_SGN_S_P_CNT + M.LAST_MWA_SGN_S_C_CNT + M.LAST_MWI_SGN_S_P_CNT + M.LAST_MWI_SGN_S_C_CNT + M.LAST_MW_SGN_S_P_CNT + M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_S_P_CNT) LAST_MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWA_SGN_S_C_CNT) LAST_MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_P_CNT) LAST_MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_C_CNT) LAST_MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_P_CNT) LAST_MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_C_CNT -->
		,		SUM(M.LAST_MAA_SGN_O_CNT + M.LAST_MAI_SGN_O_CNT) LAST_MA_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_O_CNT) LAST_MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_O_CNT) LAST_MAI_SGN_O_CNT -->
		,		SUM(M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAI_SGN_S_P_CNT + M.LAST_MAI_SGN_S_C_CNT) LAST_MA_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_S_P_CNT) LAST_MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAA_SGN_S_C_CNT) LAST_MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_P_CNT) LAST_MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_C_CNT) LAST_MAI_SGN_S_C_CNT -->
		,		SUM(M.LAST_PW_SGN_O_CNT) LAST_PW_SGN_O_CNT
		,		SUM(M.LAST_PW_SGN_S_P_CNT + M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_PW_SGN_S_P_CNT) LAST_PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_C_CNT -->
		FROM (
			SELECT	    SRD.YMD
				,		NVL(A.MAA_SGN_O_CNT, 0) MAA_SGN_O_CNT
				,		NVL(A.MAA_SGN_S_C_CNT, 0) MAA_SGN_S_C_CNT
				,		NVL(A.MAA_SGN_S_P_CNT, 0) MAA_SGN_S_P_CNT
				,		NVL(A.MAI_SGN_O_CNT, 0) MAI_SGN_O_CNT
				,		NVL(A.MAI_SGN_S_C_CNT, 0) MAI_SGN_S_C_CNT
				,		NVL(A.MAI_SGN_S_P_CNT, 0) MAI_SGN_S_P_CNT
				,		NVL(A.MW_SGN_O_CNT, 0) MW_SGN_O_CNT
				,		NVL(A.MW_SGN_S_C_CNT, 0) MW_SGN_S_C_CNT
				,		NVL(A.MW_SGN_S_P_CNT, 0) MW_SGN_S_P_CNT
				,		NVL(A.MWA_SGN_O_CNT, 0) MWA_SGN_O_CNT
				,		NVL(A.MWA_SGN_S_C_CNT, 0) MWA_SGN_S_C_CNT
				,		NVL(A.MWA_SGN_S_P_CNT, 0) MWA_SGN_S_P_CNT
				,		NVL(A.MWI_SGN_O_CNT, 0) MWI_SGN_O_CNT
				,		NVL(A.MWI_SGN_S_C_CNT, 0) MWI_SGN_S_C_CNT
				,		NVL(A.MWI_SGN_S_P_CNT, 0) MWI_SGN_S_P_CNT
				,		NVL(A.PW_SGN_O_CNT, 0) PW_SGN_O_CNT
				,		NVL(A.PW_SGN_S_C_CNT, 0) PW_SGN_S_C_CNT
				,		NVL(A.PW_SGN_S_P_CNT, 0) PW_SGN_S_P_CNT
				,		NVL(B.MAA_SGN_O_CNT, 0) LAST_MAA_SGN_O_CNT
				,		NVL(B.MAA_SGN_S_C_CNT, 0) LAST_MAA_SGN_S_C_CNT
				,		NVL(B.MAA_SGN_S_P_CNT, 0) LAST_MAA_SGN_S_P_CNT
				,		NVL(B.MAI_SGN_O_CNT, 0) LAST_MAI_SGN_O_CNT
				,		NVL(B.MAI_SGN_S_C_CNT, 0) LAST_MAI_SGN_S_C_CNT
				,		NVL(B.MAI_SGN_S_P_CNT, 0) LAST_MAI_SGN_S_P_CNT
				,		NVL(B.MW_SGN_O_CNT, 0) LAST_MW_SGN_O_CNT
				,		NVL(B.MW_SGN_S_C_CNT, 0) LAST_MW_SGN_S_C_CNT
				,		NVL(B.MW_SGN_S_P_CNT, 0) LAST_MW_SGN_S_P_CNT
				,		NVL(B.MWA_SGN_O_CNT, 0) LAST_MWA_SGN_O_CNT
				,		NVL(B.MWA_SGN_S_C_CNT, 0) LAST_MWA_SGN_S_C_CNT
				,		NVL(B.MWA_SGN_S_P_CNT, 0) LAST_MWA_SGN_S_P_CNT
				,		NVL(B.MWI_SGN_O_CNT, 0) LAST_MWI_SGN_O_CNT
				,		NVL(B.MWI_SGN_S_C_CNT, 0) LAST_MWI_SGN_S_C_CNT
				,		NVL(B.MWI_SGN_S_P_CNT, 0) LAST_MWI_SGN_S_P_CNT
				,		NVL(B.PW_SGN_O_CNT, 0) LAST_PW_SGN_O_CNT
				,		NVL(B.PW_SGN_S_C_CNT, 0) LAST_PW_SGN_S_C_CNT
				,		NVL(B.PW_SGN_S_P_CNT, 0) LAST_PW_SGN_S_P_CNT
			FROM STATIS_REF_DATE SRD
				LEFT OUTER JOIN STATIS_SGN_DATE A
				ON SRD.S_YEAR = A.S_YEAR
				AND SRD.S_MONTH = A.S_MONTH
				AND SRD.S_DATE = A.S_DATE
				LEFT OUTER JOIN STATIS_SGN_DATE B	
                ON SRD.YMD = TO_CHAR(TO_DATE(B.S_YEAR||B.S_MONTH||B.S_DATE, 'YYYYMMDD') + #{gap, jdbcType=NUMERIC}, 'YYYYMMDD') 
			WHERE SRD.YMD BETWEEN #{date} AND #{last_date}
			) M
			GROUP BY ROLLUP(M.YMD)
	</select>

	
	<select id="selectSignupMonthStatis" parameterType="HashMap" resultType="HashMap">
		SELECT 	M.YMD
			,		SUM(M.MWA_SGN_O_CNT + M.MWI_SGN_O_CNT + M.MW_SGN_O_CNT) MW_SGN_O_CNT
<!-- 		,		SUM(M.MWA_SGN_O_CNT) MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.MWI_SGN_O_CNT) MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.MW_SGN_O_CNT) MW_SGN_O_CNT -->
		,		SUM(M.MWA_SGN_S_P_CNT + M.MWA_SGN_S_C_CNT + M.MWI_SGN_S_P_CNT + M.MWI_SGN_S_C_CNT + M.MW_SGN_S_P_CNT + M.MW_SGN_S_C_CNT) MW_SGN_S_CNT
<!-- 		,		SUM(M.MWA_SGN_S_P_CNT) MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWA_SGN_S_C_CNT) MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_P_CNT) MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MWI_SGN_S_C_CNT) MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_P_CNT) MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MW_SGN_S_C_CNT) MW_SGN_S_C_CNT -->
		,		SUM(M.MAA_SGN_O_CNT + M.MAI_SGN_O_CNT) MA_SGN_O_CNT
<!-- 		,		SUM(M.MAA_SGN_O_CNT) MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.MAI_SGN_O_CNT) MAI_SGN_O_CNT -->
		,		SUM(M.MAA_SGN_S_P_CNT + M.MAA_SGN_S_P_CNT + M.MAI_SGN_S_P_CNT + M.MAI_SGN_S_C_CNT) MA_SGN_S_CNT
<!-- 		,		SUM(M.MAA_SGN_S_P_CNT) MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAA_SGN_S_C_CNT) MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_P_CNT) MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.MAI_SGN_S_C_CNT) MAI_SGN_S_C_CNT -->
		,		SUM(M.PW_SGN_O_CNT) PW_SGN_O_CNT
		,		SUM(M.PW_SGN_S_P_CNT + M.PW_SGN_S_C_CNT) PW_SGN_S_CNT
<!-- 		,		SUM(M.PW_SGN_S_P_CNT) PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.PW_SGN_S_C_CNT) PW_SGN_S_C_CNT -->

		,		SUM(M.LAST_MWA_SGN_O_CNT + M.LAST_MWI_SGN_O_CNT + M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_O_CNT) LAST_MWA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_O_CNT) LAST_MWI_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_O_CNT) LAST_MW_SGN_O_CNT -->
		,		SUM(M.LAST_MWA_SGN_S_P_CNT + M.LAST_MWA_SGN_S_C_CNT + M.LAST_MWI_SGN_S_P_CNT + M.LAST_MWI_SGN_S_C_CNT + M.LAST_MW_SGN_S_P_CNT + M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MWA_SGN_S_P_CNT) LAST_MWA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWA_SGN_S_C_CNT) LAST_MWA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_P_CNT) LAST_MWI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MWI_SGN_S_C_CNT) LAST_MWI_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_P_CNT) LAST_MW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MW_SGN_S_C_CNT) LAST_MW_SGN_S_C_CNT -->
		,		SUM(M.LAST_MAA_SGN_O_CNT + M.LAST_MAI_SGN_O_CNT) LAST_MA_SGN_O_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_O_CNT) LAST_MAA_SGN_O_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_O_CNT) LAST_MAI_SGN_O_CNT -->
		,		SUM(M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAA_SGN_S_P_CNT + M.LAST_MAI_SGN_S_P_CNT + M.LAST_MAI_SGN_S_C_CNT) LAST_MA_SGN_S_CNT
<!-- 		,		SUM(M.LAST_MAA_SGN_S_P_CNT) LAST_MAA_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAA_SGN_S_C_CNT) LAST_MAA_SGN_S_C_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_P_CNT) LAST_MAI_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_MAI_SGN_S_C_CNT) LAST_MAI_SGN_S_C_CNT -->
		,		SUM(M.LAST_PW_SGN_O_CNT) LAST_PW_SGN_O_CNT
		,		SUM(M.LAST_PW_SGN_S_P_CNT + M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_CNT
<!-- 		,		SUM(M.LAST_PW_SGN_S_P_CNT) LAST_PW_SGN_S_P_CNT -->
<!-- 		,		SUM(M.LAST_PW_SGN_S_C_CNT) LAST_PW_SGN_S_C_CNT -->
		FROM (
			SELECT	SRD.YMD
				,		NVL(A.MAA_SGN_O_CNT, 0) MAA_SGN_O_CNT
				,		NVL(A.MAA_SGN_S_C_CNT, 0) MAA_SGN_S_C_CNT
				,		NVL(A.MAA_SGN_S_P_CNT, 0) MAA_SGN_S_P_CNT
				,		NVL(A.MAI_SGN_O_CNT, 0) MAI_SGN_O_CNT
				,		NVL(A.MAI_SGN_S_C_CNT, 0) MAI_SGN_S_C_CNT
				,		NVL(A.MAI_SGN_S_P_CNT, 0) MAI_SGN_S_P_CNT
				,		NVL(A.MW_SGN_O_CNT, 0) MW_SGN_O_CNT
				,		NVL(A.MW_SGN_S_C_CNT, 0) MW_SGN_S_C_CNT
				,		NVL(A.MW_SGN_S_P_CNT, 0) MW_SGN_S_P_CNT
				,		NVL(A.MWA_SGN_O_CNT, 0) MWA_SGN_O_CNT
				,		NVL(A.MWA_SGN_S_C_CNT, 0) MWA_SGN_S_C_CNT
				,		NVL(A.MWA_SGN_S_P_CNT, 0) MWA_SGN_S_P_CNT
				,		NVL(A.MWI_SGN_O_CNT, 0) MWI_SGN_O_CNT
				,		NVL(A.MWI_SGN_S_C_CNT, 0) MWI_SGN_S_C_CNT
				,		NVL(A.MWI_SGN_S_P_CNT, 0) MWI_SGN_S_P_CNT
				,		NVL(A.PW_SGN_O_CNT, 0) PW_SGN_O_CNT
				,		NVL(A.PW_SGN_S_C_CNT, 0) PW_SGN_S_C_CNT
				,		NVL(A.PW_SGN_S_P_CNT, 0) PW_SGN_S_P_CNT
				,		NVL(B.MAA_SGN_O_CNT, 0) LAST_MAA_SGN_O_CNT
				,		NVL(B.MAA_SGN_S_C_CNT, 0) LAST_MAA_SGN_S_C_CNT
				,		NVL(B.MAA_SGN_S_P_CNT, 0) LAST_MAA_SGN_S_P_CNT
				,		NVL(B.MAI_SGN_O_CNT, 0) LAST_MAI_SGN_O_CNT
				,		NVL(B.MAI_SGN_S_C_CNT, 0) LAST_MAI_SGN_S_C_CNT
				,		NVL(B.MAI_SGN_S_P_CNT, 0) LAST_MAI_SGN_S_P_CNT
				,		NVL(B.MW_SGN_O_CNT, 0) LAST_MW_SGN_O_CNT
				,		NVL(B.MW_SGN_S_C_CNT, 0) LAST_MW_SGN_S_C_CNT
				,		NVL(B.MW_SGN_S_P_CNT, 0) LAST_MW_SGN_S_P_CNT
				,		NVL(B.MWA_SGN_O_CNT, 0) LAST_MWA_SGN_O_CNT
				,		NVL(B.MWA_SGN_S_C_CNT, 0) LAST_MWA_SGN_S_C_CNT
				,		NVL(B.MWA_SGN_S_P_CNT, 0) LAST_MWA_SGN_S_P_CNT
				,		NVL(B.MWI_SGN_O_CNT, 0) LAST_MWI_SGN_O_CNT
				,		NVL(B.MWI_SGN_S_C_CNT, 0) LAST_MWI_SGN_S_C_CNT
				,		NVL(B.MWI_SGN_S_P_CNT, 0) LAST_MWI_SGN_S_P_CNT
				,		NVL(B.PW_SGN_O_CNT, 0) LAST_PW_SGN_O_CNT
				,		NVL(B.PW_SGN_S_C_CNT, 0) LAST_PW_SGN_S_C_CNT
				,		NVL(B.PW_SGN_S_P_CNT, 0) LAST_PW_SGN_S_P_CNT
			FROM STATIS_REF_DATE SRD
				LEFT OUTER JOIN STATIS_SGN_DATE A
				ON SRD.S_YEAR = A.S_YEAR
				AND SRD.S_MONTH = A.S_MONTH
				AND SRD.S_DATE = A.S_DATE
				LEFT OUTER JOIN STATIS_SGN_DATE B	
				ON SRD.S_YEAR = B.S_YEAR
				AND SRD.S_MONTH = B.S_MONTH - 1
				AND SRD.S_DATE = B.S_DATE
			WHERE SRD.YM = #{date}
			) M
		GROUP BY ROLLUP(M.YMD)
	</select>
	
	<insert id="insertStatisDateOra" parameterType="HashMap">
	INSERT INTO STATIS_REF_DATE
		(
				S_YEAR
			,	S_MONTH
			,	S_DATE
			,	YMD
			,	YM
		)
		VALUES
		(
				TO_CHAR(TO_DATE(#{date}, 'YYYYMMDD') + #{plus}, 'YYYY')
			,	TO_CHAR(TO_DATE(#{date}, 'YYYYMMDD') + #{plus}, 'MM')
			,	TO_CHAR(TO_DATE(#{date}, 'YYYYMMDD') + #{plus}, 'DD')
			,	TO_CHAR(TO_DATE(#{date}, 'YYYYMMDD') + #{plus}, 'YYYYMMDD')
			,	TO_CHAR(TO_DATE(#{date}, 'YYYYMMDD') + #{plus}, 'YYYYMM')
		)
</insert>
</mapper>
